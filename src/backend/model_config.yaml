# model_config.yaml
# ì´ë¯¸ì§€ ìƒì„± ëª¨ë¸ ì„¤ì • íŒŒì¼
# ìƒˆ ëª¨ë¸ ì¶”ê°€ ì‹œ ì´ íŒŒì¼ë§Œ ìˆ˜ì •í•˜ë©´ ë¨

models:
  # FLUX ëª¨ë¸ (ìµœì‹ , ê³ í’ˆì§ˆ, í•œêµ­ì–´ ì§€ì› ìš°ìˆ˜)
  flux-schnell:
    id: "black-forest-labs/FLUX.1-schnell"
    type: "flux"
    requires_auth: true
    params:
      default_steps: 4
      max_steps: 8
      use_negative_prompt: false
      guidance_scale: null
      supports_i2i: true
      max_tokens: 512
      default_size: [1024, 1024]
      max_size: [2048, 2048]
    description: "ë¹ ë¥¸ ìƒì„±, 4 steps ê¶Œì¥"
    
  flux-dev:
    id: "black-forest-labs/FLUX.1-dev"
    type: "flux"
    requires_auth: true
    params:
      default_steps: 28
      max_steps: 50
      use_negative_prompt: false
      guidance_scale: 3.5
      supports_i2i: true
      max_tokens: 512
      default_size: [1024, 1024]
      max_size: [2048, 2048]
    description: "ê³ í’ˆì§ˆ, ëŠë¦¼"

  # GCP VM ì „ìš© flux-dev (ë¡œì»¬ ê²½ë¡œ)
  flux-dev-gcp:
    id: "/home/shared/FLUX.1-dev"  # GCP VM ë¡œì»¬ ê²½ë¡œ
    type: "flux"
    requires_auth: false  # ì´ë¯¸ ë‹¤ìš´ë¡œë“œë¨
    params:
      default_steps: 28
      max_steps: 50
      use_negative_prompt: false
      guidance_scale: 3.5
      supports_i2i: true
      max_tokens: 512
      default_size: [1024, 1024]
      max_size: [2048, 2048]
    description: "GCP VMìš© FLUX.1-dev (ë¡œì»¬)"

  # ì‚¬ì „ ì–‘ìí™”ëœ FP8 ëª¨ë¸ (ë¡œë”© ë¹ ë¦„, ë§¤ë²ˆ ì–‘ìí™” ë¶ˆí•„ìš”) â­ ê¶Œì¥
  flux-dev-fp8:
    id: "diffusers/FLUX.1-dev-torchao-fp8"
    type: "flux-quantized"  # ì‚¬ì „ ì–‘ìí™” íƒ€ì…
    requires_auth: false
    params:
      default_steps: 28
      max_steps: 50
      use_negative_prompt: false
      guidance_scale: 3.5
      supports_i2i: true
      max_tokens: 512
      default_size: [1024, 1024]
      max_size: [2048, 2048]
    description: "FLUX.1-dev FP8 (ì‚¬ì „ ì–‘ìí™”, ë¹ ë¥¸ ë¡œë”©, ~12GB)"
  
  # Stable Diffusion XL (ì•ˆì •ì , í´ë°±ìš©)
  sdxl:
    id: "stabilityai/stable-diffusion-xl-base-1.0"
    type: "sdxl"
    requires_auth: false
    params:
      default_steps: 30
      max_steps: 50
      use_negative_prompt: true
      guidance_scale: 7.5
      supports_i2i: true
      max_tokens: 77
      default_size: [1024, 1024]
      max_size: [2048, 2048]
      negative_prompt: "low quality, blurry, text, watermark, distorted, ugly, tiling"
    description: "ì•ˆì •ì , ë¬´ë£Œ"
  
  # Stable Diffusion 3
  sd3:
    id: "stabilityai/stable-diffusion-3-medium-diffusers"
    type: "sd3"
    requires_auth: true
    params:
      default_steps: 28
      max_steps: 50
      use_negative_prompt: true
      guidance_scale: 7.0
      supports_i2i: true
      max_tokens: 77
      default_size: [1024, 1024]
      max_size: [2048, 2048]
      negative_prompt: "low quality, blurry, distorted"
    description: "SD3, í…ìŠ¤íŠ¸ ë Œë”ë§ ê°œì„ "
  
  # Kandinsky 3 (ë‹¤êµ­ì–´ ì§€ì›)
  kandinsky:
    id: "kandinsky-community/kandinsky-3"
    type: "kandinsky"
    requires_auth: false
    params:
      default_steps: 25
      max_steps: 50
      use_negative_prompt: true
      guidance_scale: 7.0
      supports_i2i: true
      max_tokens: 77
      default_size: [1024, 1024]
      max_size: [1536, 1536]
      negative_prompt: "low quality, blurry"
    description: "ëŸ¬ì‹œì•„ ëª¨ë¸, ë‹¤êµ­ì–´"
  
  # Playground v2.5
  playground:
    id: "playgroundai/playground-v2.5-1024px-aesthetic"
    type: "sdxl"
    requires_auth: false
    params:
      default_steps: 25
      max_steps: 50
      use_negative_prompt: false
      guidance_scale: 3.0
      supports_i2i: true
      max_tokens: 77
      default_size: [1024, 1024]
      max_size: [1536, 1536]
    description: "ë¯¸ì  í’ˆì§ˆ ìµœì í™”"

# ì‹¤í–‰ ì„¤ì •
runtime:
  # ========================================
  # ğŸš€ ì„±ëŠ¥ ëª¨ë“œ ì„ íƒ
  # ========================================
  # primary_modelì€ ê³ ì •: "flux-dev-gcp"
  # quantization_typeìœ¼ë¡œ ëª¨ë“œ ì„ íƒ:
  #
  # ëª¨ë“œ 1: quantization_type = "none" (ì›ë³¸ + CPU offload)
  #   - ì†ë„: 50-60ë¶„/ì´ë¯¸ì§€
  #   - í’ˆì§ˆ: 100%
  #   - ë©”ëª¨ë¦¬: Sequential CPU offload ì‚¬ìš©
  #   - ë””ìŠ¤í¬: /home/shared/FLUX.1-dev ë§Œ ì‚¬ìš© (22GB)
  #   - ì„œë²„ ì‹œì‘: ë¹ ë¦„
  #
  # ëª¨ë“œ 2: quantization_type = "fp8" (FP8 ì–‘ìí™”, ê¸°ë³¸ê°’)
  #   - ì†ë„: 19-25ë¶„/ì´ë¯¸ì§€ (2-2.6ë°° ë¹ ë¦„)
  #   - í’ˆì§ˆ: 99%+
  #   - ë©”ëª¨ë¦¬: GPU 100% í™œìš© (CPU offload ë¶ˆí•„ìš”)
  #   - ë””ìŠ¤í¬: /home/shared/FLUX.1-dev-fp8 ìƒì„± (ì¶”ê°€ 12GB)
  #   - ì„œë²„ ì‹œì‘: ì²« ì‹¤í–‰ 5-15ë¶„ (ì–‘ìí™”), ì´í›„ ë¹ ë¦„
  #
  # ëª¨ë“œ 3: quantization_type = "nf4" (NF4 ì–‘ìí™”, ê°€ì¥ ë¹ ë¦„)
  #   - ì†ë„: 12-17ë¶„/ì´ë¯¸ì§€ (3-4ë°° ë¹ ë¦„)
  #   - í’ˆì§ˆ: 98%
  #   - ë©”ëª¨ë¦¬: GPU 100% í™œìš©
  #   - ë””ìŠ¤í¬: /home/shared/FLUX.1-dev ë§Œ ì‚¬ìš© (NF4ëŠ” ì €ì¥ ë¯¸ì§€ì›)
  #   - ì„œë²„ ì‹œì‘: ë§¤ë²ˆ 5-15ë¶„ (ì–‘ìí™”)
  # ========================================

  primary_model: "flux-dev-fp8"  # ì‚¬ì „ ì–‘ìí™” ëª¨ë¸ (ê¶Œì¥)

  # í´ë°± ëª¨ë¸ ì²´ì¸ (ìˆœì„œëŒ€ë¡œ ì‹œë„)
  fallback_models:
    - "flux-schnell"
    - "playground"

  # í´ë°± í™œì„±í™” ì—¬ë¶€
  enable_fallback: false  # ë””ìŠ¤í¬ ìš©ëŸ‰ ì ˆì•½
  
  # í”„ë¡¬í”„íŠ¸ ìµœì í™” ì„¤ì •
  prompt_optimization:
    enabled: true
    translate_korean: true
    max_length_by_model: true  # ëª¨ë¸ë³„ í† í° ì œí•œ ì¤€ìˆ˜
  
  # ë©”ëª¨ë¦¬ ìµœì í™” ë° ì†ë„ ê°œì„ 
  memory:
    # ========================================
    # ğŸ¯ ì„±ëŠ¥ ëª¨ë“œ ì„ íƒ (ì—¬ê¸°ë§Œ ìˆ˜ì •í•˜ë©´ ë¨!)
    # ========================================
    # "none"  â†’ ëª¨ë“œ 1: ì›ë³¸ + CPU offload (50-60ë¶„, í’ˆì§ˆ 100%)
    # "fp8"   â†’ ëª¨ë“œ 2: FP8 ì–‘ìí™” (19-25ë¶„, í’ˆì§ˆ 99%+) â­ ê¸°ë³¸ê°’
    # "nf4"   â†’ ëª¨ë“œ 3: NF4 ì–‘ìí™” (12-17ë¶„, í’ˆì§ˆ 98%)
    # ========================================
    quantization_type: "fp8"  # í˜„ì¬ ëª¨ë“œ: FP8 (ë³€ê²½: "none", "fp8", "nf4")

    # CPU offload (ì–‘ìí™” ì‚¬ìš© ì‹œ ìë™ ë¹„í™œì„±í™”ë¨)
    enable_cpu_offload: true  # ì–‘ìí™” ë¯¸ì‚¬ìš© ì‹œì—ë§Œ ì ìš©

    # Attention ìµœì í™” (ì–‘ìí™”ì™€ í•¨ê»˜ ì‚¬ìš© ì‹œ ì¶”ê°€ ì†ë„ ê°œì„ )
    use_flash_attention: false  # Flash Attention 2 (ì„¤ì¹˜ ë³µì¡, ë¹„í™œì„±í™”)
    enable_attention_slicing: true  # ì¶”ê°€ ë©”ëª¨ë¦¬ ì ˆì•½

    # VAE ìµœì í™”
    enable_vae_slicing: true  # VAE ìŠ¬ë¼ì´ì‹±

    # ê¸°íƒ€ (deprecated)
    use_8bit: false  # ì‚¬ìš© ì•ˆ í•¨ (quantization_type ì‚¬ìš©)