# model_config.yaml
# ì´ë¯¸ì§€ ìƒì„± ëª¨ë¸ ì„¤ì • íŒŒì¼
# ìƒˆ ëª¨ë¸ ì¶”ê°€ ì‹œ ì´ íŒŒì¼ë§Œ ìˆ˜ì •í•˜ë©´ ë¨

models:
  # FLUX ëª¨ë¸ (ìµœì‹ , ê³ í’ˆì§ˆ, í•œêµ­ì–´ ì§€ì› ìš°ìˆ˜)
  flux-schnell:
    id: "black-forest-labs/FLUX.1-schnell"
    type: "flux"
    requires_auth: true
    params:
      default_steps: 4
      max_steps: 8
      use_negative_prompt: false
      guidance_scale: null
      supports_i2i: true
      max_tokens: 512
      default_size: [1024, 1024]
      max_size: [2048, 2048]
    description: "ë¹ ë¥¸ ìƒì„±, 4 steps ê¶Œì¥"
    
  flux-dev:
    id: "black-forest-labs/FLUX.1-dev"
    type: "flux"
    requires_auth: true
    params:
      default_steps: 28
      max_steps: 50
      use_negative_prompt: false
      guidance_scale: 3.5
      supports_i2i: true
      max_tokens: 512
      default_size: [1024, 1024]
      max_size: [2048, 2048]
    description: "ê³ í’ˆì§ˆ, ëŠë¦¼"

  # GCP VM ì „ìš© flux-dev (ë¡œì»¬ ê²½ë¡œ)
  flux-dev-gcp:
    id: "/home/shared/FLUX.1-dev"  # GCP VM ë¡œì»¬ ê²½ë¡œ
    type: "flux"
    requires_auth: false  # ì´ë¯¸ ë‹¤ìš´ë¡œë“œë¨
    params:
      default_steps: 28
      max_steps: 50
      use_negative_prompt: false
      guidance_scale: 3.5
      supports_i2i: true
      max_tokens: 512
      default_size: [1024, 1024]
      max_size: [2048, 2048]
    description: "GCP VMìš© FLUX.1-dev (ë¡œì»¬)"

  # ì‚¬ì „ ì–‘ìí™”ëœ FP8 ëª¨ë¸ (ë¡œë”© ë¹ ë¦„, ë§¤ë²ˆ ì–‘ìí™” ë¶ˆí•„ìš”)
  flux-dev-fp8:
    id: "Kijai/flux-fp8"  # ê³µì‹ FP8 ëª¨ë¸
    type: "flux"
    requires_auth: false
    params:
      default_steps: 28
      max_steps: 50
      use_negative_prompt: false
      guidance_scale: 3.5
      supports_i2i: true
      max_tokens: 512
      default_size: [1024, 1024]
      max_size: [2048, 2048]
    description: "FLUX.1-dev FP8 (ì‚¬ì „ ì–‘ìí™”, ë¹ ë¥¸ ë¡œë”©)"
  
  # Stable Diffusion XL (ì•ˆì •ì , í´ë°±ìš©)
  sdxl:
    id: "stabilityai/stable-diffusion-xl-base-1.0"
    type: "sdxl"
    requires_auth: false
    params:
      default_steps: 30
      max_steps: 50
      use_negative_prompt: true
      guidance_scale: 7.5
      supports_i2i: true
      max_tokens: 77
      default_size: [1024, 1024]
      max_size: [2048, 2048]
      negative_prompt: "low quality, blurry, text, watermark, distorted, ugly, tiling"
    description: "ì•ˆì •ì , ë¬´ë£Œ"
  
  # Stable Diffusion 3
  sd3:
    id: "stabilityai/stable-diffusion-3-medium-diffusers"
    type: "sd3"
    requires_auth: true
    params:
      default_steps: 28
      max_steps: 50
      use_negative_prompt: true
      guidance_scale: 7.0
      supports_i2i: true
      max_tokens: 77
      default_size: [1024, 1024]
      max_size: [2048, 2048]
      negative_prompt: "low quality, blurry, distorted"
    description: "SD3, í…ìŠ¤íŠ¸ ë Œë”ë§ ê°œì„ "
  
  # Kandinsky 3 (ë‹¤êµ­ì–´ ì§€ì›)
  kandinsky:
    id: "kandinsky-community/kandinsky-3"
    type: "kandinsky"
    requires_auth: false
    params:
      default_steps: 25
      max_steps: 50
      use_negative_prompt: true
      guidance_scale: 7.0
      supports_i2i: true
      max_tokens: 77
      default_size: [1024, 1024]
      max_size: [1536, 1536]
      negative_prompt: "low quality, blurry"
    description: "ëŸ¬ì‹œì•„ ëª¨ë¸, ë‹¤êµ­ì–´"
  
  # Playground v2.5
  playground:
    id: "playgroundai/playground-v2.5-1024px-aesthetic"
    type: "sdxl"
    requires_auth: false
    params:
      default_steps: 25
      max_steps: 50
      use_negative_prompt: false
      guidance_scale: 3.0
      supports_i2i: true
      max_tokens: 77
      default_size: [1024, 1024]
      max_size: [1536, 1536]
    description: "ë¯¸ì  í’ˆì§ˆ ìµœì í™”"

# ì‹¤í–‰ ì„¤ì •
runtime:
  # ========================================
  # ğŸš€ ì„±ëŠ¥ ëª¨ë“œ ì„ íƒ (ì•„ë˜ ì¤‘ í•˜ë‚˜ ì„ íƒ)
  # ========================================
  # ì˜µì…˜ 1: flux-dev-gcp (ì›ë³¸ ëª¨ë¸ + CPU offload)
  #   - ì†ë„: 50-60ë¶„/ì´ë¯¸ì§€
  #   - í’ˆì§ˆ: 100%
  #   - ë©”ëª¨ë¦¬: Sequential CPU offload ì‚¬ìš©
  #   - ë””ìŠ¤í¬: ê¸°ì¡´ /home/shared/FLUX.1-dev ì‚¬ìš©
  #
  # ì˜µì…˜ 2: flux-dev-fp8 (ì‚¬ì „ ì–‘ìí™” ëª¨ë¸)
  #   - ì†ë„: 19-25ë¶„/ì´ë¯¸ì§€ (2-2.6ë°° ë¹ ë¦„)
  #   - í’ˆì§ˆ: 99%+
  #   - ë©”ëª¨ë¦¬: GPU 100% í™œìš© (CPU offload ë¶ˆí•„ìš”)
  #   - ë””ìŠ¤í¬: ì²« ì‹¤í–‰ ì‹œ ~12GB ë‹¤ìš´ë¡œë“œ (í•œ ë²ˆë§Œ)
  # ========================================

  primary_model: "flux-dev-gcp"  # ê¸°ë³¸ê°’: ì›ë³¸ ëª¨ë¸ (FP8 ì‚¬ì „ ì–‘ìí™” ëª¨ë¸ ì—†ìŒ)

  # í´ë°± ëª¨ë¸ ì²´ì¸ (ìˆœì„œëŒ€ë¡œ ì‹œë„)
  fallback_models:
    - "flux-schnell"
    - "playground"

  # í´ë°± í™œì„±í™” ì—¬ë¶€
  enable_fallback: false  # ë””ìŠ¤í¬ ìš©ëŸ‰ ì ˆì•½
  
  # í”„ë¡¬í”„íŠ¸ ìµœì í™” ì„¤ì •
  prompt_optimization:
    enabled: true
    translate_korean: true
    max_length_by_model: true  # ëª¨ë¸ë³„ í† í° ì œí•œ ì¤€ìˆ˜
  
  # ë©”ëª¨ë¦¬ ìµœì í™” ë° ì†ë„ ê°œì„ 
  memory:
    # ì–‘ìí™” ì„¤ì • (FLUX ì „ìš©, 22GB â†’ 12GB ì••ì¶•)
    # ì˜µì…˜: "fp8" (í’ˆì§ˆ ìš°ì„ , 2-2.6ë°°), "nf4" (ì†ë„ ìš°ì„ , 3-4ë°°), "none" (ì–‘ìí™” ì•ˆ í•¨)
    quantization_type: "fp8"  # ê¸°ë³¸ê°’: FP8 (í’ˆì§ˆ 99%+, ì†ë„ 2-2.6ë°°)

    # CPU offload (ì–‘ìí™” ì‚¬ìš© ì‹œ ìë™ ë¹„í™œì„±í™”ë¨)
    enable_cpu_offload: true  # ì–‘ìí™” ë¯¸ì‚¬ìš© ì‹œì—ë§Œ ì ìš©

    # Attention ìµœì í™” (ì–‘ìí™”ì™€ í•¨ê»˜ ì‚¬ìš© ì‹œ ì¶”ê°€ ì†ë„ ê°œì„ )
    use_flash_attention: false  # Flash Attention 2 (ì„¤ì¹˜ ë³µì¡, ë¹„í™œì„±í™”)
    enable_attention_slicing: true  # ì¶”ê°€ ë©”ëª¨ë¦¬ ì ˆì•½

    # VAE ìµœì í™”
    enable_vae_slicing: true  # VAE ìŠ¬ë¼ì´ì‹±

    # ê¸°íƒ€ (deprecated)
    use_8bit: false  # ì‚¬ìš© ì•ˆ í•¨ (quantization_type ì‚¬ìš©)