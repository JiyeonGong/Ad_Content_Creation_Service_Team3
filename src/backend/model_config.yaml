# model_config.yaml
# 이미지 생성 모델 설정 파일
# 새 모델 추가 시 이 파일만 수정하면 됨

models:
  # FLUX 모델 (최신, 고품질, 한국어 지원 우수)
  flux-schnell:
    id: "black-forest-labs/FLUX.1-schnell"
    type: "flux"
    requires_auth: true
    params:
      default_steps: 4
      max_steps: 8
      use_negative_prompt: false
      guidance_scale: null
      supports_i2i: true
      max_tokens: 512
      default_size: [1024, 1024]
      max_size: [2048, 2048]
    description: "빠른 생성, 4 steps 권장"
    
  flux-dev:
    id: "black-forest-labs/FLUX.1-dev"
    type: "flux"
    requires_auth: true
    params:
      default_steps: 28
      max_steps: 50
      use_negative_prompt: false
      guidance_scale: 3.5
      supports_i2i: true
      max_tokens: 512
      default_size: [1024, 1024]
      max_size: [2048, 2048]
    description: "고품질, 느림"

  # GCP VM 전용 flux-dev (로컬 경로)
  flux-dev-gcp:
    id: "/home/shared/FLUX.1-dev"  # GCP VM 로컬 경로
    type: "flux"
    requires_auth: false  # 이미 다운로드됨
    params:
      default_steps: 28
      max_steps: 50
      use_negative_prompt: false
      guidance_scale: 3.5
      supports_i2i: true
      max_tokens: 512
      default_size: [1024, 1024]
      max_size: [2048, 2048]
    description: "GCP VM용 FLUX.1-dev (로컬)"
  
  # Stable Diffusion XL (안정적, 폴백용)
  sdxl:
    id: "stabilityai/stable-diffusion-xl-base-1.0"
    type: "sdxl"
    requires_auth: false
    params:
      default_steps: 30
      max_steps: 50
      use_negative_prompt: true
      guidance_scale: 7.5
      supports_i2i: true
      max_tokens: 77
      default_size: [1024, 1024]
      max_size: [2048, 2048]
      negative_prompt: "low quality, blurry, text, watermark, distorted, ugly, tiling"
    description: "안정적, 무료"
  
  # Stable Diffusion 3
  sd3:
    id: "stabilityai/stable-diffusion-3-medium-diffusers"
    type: "sd3"
    requires_auth: true
    params:
      default_steps: 28
      max_steps: 50
      use_negative_prompt: true
      guidance_scale: 7.0
      supports_i2i: true
      max_tokens: 77
      default_size: [1024, 1024]
      max_size: [2048, 2048]
      negative_prompt: "low quality, blurry, distorted"
    description: "SD3, 텍스트 렌더링 개선"
  
  # Kandinsky 3 (다국어 지원)
  kandinsky:
    id: "kandinsky-community/kandinsky-3"
    type: "kandinsky"
    requires_auth: false
    params:
      default_steps: 25
      max_steps: 50
      use_negative_prompt: true
      guidance_scale: 7.0
      supports_i2i: true
      max_tokens: 77
      default_size: [1024, 1024]
      max_size: [1536, 1536]
      negative_prompt: "low quality, blurry"
    description: "러시아 모델, 다국어"
  
  # Playground v2.5
  playground:
    id: "playgroundai/playground-v2.5-1024px-aesthetic"
    type: "sdxl"
    requires_auth: false
    params:
      default_steps: 25
      max_steps: 50
      use_negative_prompt: false
      guidance_scale: 3.0
      supports_i2i: true
      max_tokens: 77
      default_size: [1024, 1024]
      max_size: [1536, 1536]
    description: "미적 품질 최적화"

# 실행 설정
runtime:
  # 기본 사용 모델 (환경변수로 오버라이드 가능)
  primary_model: "sdxl"

  
  # 폴백 모델 체인 (순서대로 시도)
  fallback_models:
    - "flux-schnell"
    - "playground"
  
  # 폴백 활성화 여부
  enable_fallback: true
  
  # 프롬프트 최적화 설정
  prompt_optimization:
    enabled: true
    translate_korean: true
    max_length_by_model: true  # 모델별 토큰 제한 준수
  
  # 메모리 최적화 (ai-ad 방식)
  memory:
    enable_cpu_offload: true  # CPU 오프로드 (FLUX는 sequential 사용)
    enable_attention_slicing: false  # 어텐션 슬라이싱 (선택적)
    enable_vae_slicing: true  # VAE 슬라이싱
    use_8bit: false  # 8비트 양자화 (더 느리지만 메모리 50% 절약)