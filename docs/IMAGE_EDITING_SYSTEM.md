# ğŸ¨ ì´ë¯¸ì§€ í¸ì§‘ ì‹œìŠ¤í…œ ì„¤ê³„ ë¬¸ì„œ (Page 4)

## ğŸ“‹ ëª©ì°¨
1. [ì‹œìŠ¤í…œ ê°œìš”](#-ì‹œìŠ¤í…œ-ê°œìš”)
2. [3ê°€ì§€ í¸ì§‘ ëª¨ë“œ](#-3ê°€ì§€-í¸ì§‘-ëª¨ë“œ)
3. [ê¸°ìˆ  ìŠ¤íƒ ë° ì•„í‚¤í…ì²˜](#-ê¸°ìˆ -ìŠ¤íƒ-ë°-ì•„í‚¤í…ì²˜)
4. [ì›Œí¬í”Œë¡œìš° ìƒì„¸ ì„¤ê³„](#-ì›Œí¬í”Œë¡œìš°-ìƒì„¸-ì„¤ê³„)
5. [ì§„í–‰ìƒí™© ì¶”ì  ì‹œìŠ¤í…œ](#-ì§„í–‰ìƒí™©-ì¶”ì -ì‹œìŠ¤í…œ)
6. [ì‚¬ìš©ì ì¸í„°í˜ì´ìŠ¤](#-ì‚¬ìš©ì-ì¸í„°í˜ì´ìŠ¤)
7. [ì„¤ì¹˜ ë° ì„¤ì •](#-ì„¤ì¹˜-ë°-ì„¤ì •)

---

## ğŸŒŸ ì‹œìŠ¤í…œ ê°œìš”

### ëª©ì 
ì‚¬ìš©ìê°€ ì´ë¯¸ì§€ë¥¼ ì—…ë¡œë“œí•˜ê³  í…ìŠ¤íŠ¸ í”„ë¡¬í”„íŠ¸ë§Œìœ¼ë¡œ **ì–¼êµ´ ë³´ì¡´**, **ì œí’ˆ ë³´ì¡´**, **ë°°ê²½ ë³€ê²½**ì„ ììœ ë¡­ê²Œ ìˆ˜í–‰í•  ìˆ˜ ìˆëŠ” AI ê¸°ë°˜ ì´ë¯¸ì§€ í¸ì§‘ ì‹œìŠ¤í…œ

### í•µì‹¬ ê¸°ëŠ¥
- **ğŸ‘¤ ì¸ë¬¼ ëª¨ë“œ**: ì–¼êµ´ ë³´ì¡´ + ì˜ìƒ/ë°°ê²½ ë³€ê²½
- **ğŸ“¦ ì œí’ˆ ëª¨ë“œ**: ì œí’ˆ ë³´ì¡´ + ë°°ê²½ êµì²´
- **âœ¨ ê³ ê¸‰ ëª¨ë“œ**: ì–¼êµ´+ì œí’ˆ ë³´ì¡´ + ë‚˜ë¨¸ì§€ ë³€ê²½

### ì£¼ìš” íŠ¹ì§•
âœ… **Zero-Shot Learning**: í•™ìŠµ ì—†ì´ ë°”ë¡œ ì‚¬ìš© ê°€ëŠ¥
âœ… **ê³ í’ˆì§ˆ ê²°ê³¼**: FLUX.1-dev ê¸°ë°˜ ê³ í•´ìƒë„ ìƒì„±
âœ… **ì‹¤ì‹œê°„ ì¶”ì **: íŒŒì´í”„ë¼ì¸ ë‹¨ê³„ë³„ ì§„í–‰ìƒí™© ëª¨ë‹ˆí„°ë§
âœ… **ìœ ì—°í•œ ì œì–´**: ControlNet, ë§ˆìŠ¤í¬ ê°•ë„ ë“± ì„¸ë°€í•œ ì¡°ì • ê°€ëŠ¥

---

## ğŸ¯ 3ê°€ì§€ í¸ì§‘ ëª¨ë“œ

### 1. ğŸ‘¤ ì¸ë¬¼ ëª¨ë“œ (Portrait Mode)

#### ëª©í‘œ
**ì–¼êµ´(ID) 100% ë³´ì¡´**, ì˜ìƒê³¼ ë°°ê²½ë§Œ ìì—°ìŠ¤ëŸ½ê²Œ ë³€ê²½

#### ì‚¬ìš© ì‚¬ë¡€
- ê°€ìƒ ì˜ìƒ í”¼íŒ… (íŒ¨ì…˜ e-ì»¤ë¨¸ìŠ¤)
- í”„ë¡œí•„ ì‚¬ì§„ ë°°ê²½ ë³€ê²½
- ì»¨ì…‰ í¬í†  ìƒì„± (ê²°í˜¼, ì¡¸ì—… ë“±)
- ê´‘ê³  ì†Œì¬ ì œì‘ (ì¸ë¬¼ ì»¨ì…‰ ë‹¤ì–‘í™”)

#### íŒŒì´í”„ë¼ì¸ êµ¬ì¡°
```
ì…ë ¥ ì´ë¯¸ì§€
    â†“
[1] Face Detector (ì–¼êµ´ ê°ì§€)
    â†“
[2] ì–¼êµ´ ë§ˆìŠ¤í¬ ìƒì„± â†’ ë°˜ì „ (ì–¼êµ´ ì œì™¸ ì˜ì—­)
    â†“
[3] ControlNet Preprocessor (Depth/Canny)
    â”œâ”€ Depth: ì²´í˜•/í¬ì¦ˆ ìœ ì§€
    â””â”€ Canny: ì†ê°€ë½ ë””í…Œì¼ ìœ ì§€
    â†“
[4] ControlNet + Masked I2I
    â”œâ”€ í…ìŠ¤íŠ¸ í”„ë¡¬í”„íŠ¸: "ë¹¨ê°„ ë“œë ˆìŠ¤, í•´ë³€ ë°°ê²½"
    â”œâ”€ ë§ˆìŠ¤í¬: ì–¼êµ´ ì œì™¸ ì˜ì—­ë§Œ ìˆ˜ì •
    â””â”€ ControlNet: ì²´í˜•/í¬ì¦ˆ ê°€ì´ë“œ
    â†“
ìµœì¢… ê²°ê³¼ (ì–¼êµ´ ë³´ì¡´ + ì˜ìƒ/ë°°ê²½ ë³€ê²½)
```

#### ì œì–´ íŒŒë¼ë¯¸í„°
| íŒŒë¼ë¯¸í„° | ì„¤ëª… | ë²”ìœ„ | ê¸°ë³¸ê°’ |
|---------|------|------|--------|
| **controlnet_type** | Depth(ì²´í˜• ìœ ì§€) or Canny(ë””í…Œì¼ ìœ ì§€) | depth, canny | depth |
| **controlnet_strength** | ì²´í˜• ìœ ì§€ ê°•ë„ | 0.0 ~ 1.0 | 0.7 |
| **denoise_strength** | ë³€ê²½ ê°•ë„ (1.0=ì™„ì „ ìƒˆë¡œ ê·¸ë¦¼) | 0.0 ~ 1.0 | 1.0 |
| **steps** | ìƒì„± ë°˜ë³µ íšŸìˆ˜ | 20 ~ 50 | 28 |
| **guidance_scale** | í”„ë¡¬í”„íŠ¸ ì¶©ì‹¤ë„ | 1.0 ~ 20.0 | 3.5 |

#### ë…¸ë“œ êµ¬ì„± (16ê°œ)
```yaml
1:  LoadImage              # ì´ë¯¸ì§€ ë¡œë“œ
10: UltralyticsDetector    # ì–¼êµ´ ê°ì§€ ëª¨ë¸ (YOLOv8)
12: BboxDetectorSEGS       # ì–¼êµ´ ì˜ì—­ SEGS ìƒì„±
13: SegsToCombinedMask     # ì–¼êµ´ ë§ˆìŠ¤í¬ ìƒì„±
14: InvertMask             # ë§ˆìŠ¤í¬ ë°˜ì „ (ì–¼êµ´ ì œì™¸)
20: DepthAnythingPreprocessor  # Depth ë§µ ì¶”ì¶œ
21: ControlNetLoader       # ControlNet ëª¨ë¸ ë¡œë“œ
22: ControlNetApplyAdvanced # ControlNet ì ìš©
3:  CLIPTextEncode         # í…ìŠ¤íŠ¸ ì¸ì½”ë”©
4:  UnetLoaderGGUF         # FLUX.1-dev-Q8 ë¡œë“œ
6:  CLIPTextEncode         # Negative í”„ë¡¬í”„íŠ¸
30: EmptyLatentImage       # Latent ë…¸ì´ì¦ˆ ìƒì„±
31: SetLatentNoiseMask     # ë§ˆìŠ¤í¬ ì ìš©
40: KSampler               # ì´ë¯¸ì§€ ìƒì„±
41: VAEDecode              # VAE ë””ì½”ë”©
50: SaveImage              # ê²°ê³¼ ì €ì¥
```

---

### 2. ğŸ“¦ ì œí’ˆ ëª¨ë“œ (Product Mode)

#### ëª©í‘œ
**ì œí’ˆ ë””í…Œì¼ ë³´ì¡´**, ë°°ê²½ë§Œ í™”ë ¤í•˜ê²Œ êµì²´

#### ì‚¬ìš© ì‚¬ë¡€
- ì œí’ˆ ê´‘ê³  ì†Œì¬ ì œì‘ (ë‹¤ì–‘í•œ ë°°ê²½)
- e-ì»¤ë¨¸ìŠ¤ ìƒí’ˆ ì´ë¯¸ì§€ í–¥ìƒ
- íŒ¨í‚¤ì§€ ë””ìì¸ ëª©ì—…
- SNS ë§ˆì¼€íŒ… ì½˜í…ì¸  ìƒì„±

#### íŒŒì´í”„ë¼ì¸ êµ¬ì¡°
```
ì…ë ¥ ì´ë¯¸ì§€
    â†“
[1] BEN2 ë°°ê²½ ì œê±° (ì œí’ˆ ë¶„ë¦¬)
    â”œâ”€ ì•ŒíŒŒ ì±„ë„ í¬í•¨ PNG ìƒì„±
    â””â”€ ì œí’ˆ ë§ˆìŠ¤í¬ íšë“
    â†“
[2] T2I ë°°ê²½ ìƒì„±
    â”œâ”€ í…ìŠ¤íŠ¸ í”„ë¡¬í”„íŠ¸: "ê³ ê¸‰ìŠ¤ëŸ¬ìš´ ëŒ€ë¦¬ì„ ë°°ê²½"
    â”œâ”€ FLUX.1-devë¡œ ë°°ê²½ ì´ë¯¸ì§€ ìƒì„±
    â””â”€ í•´ìƒë„: ì›ë³¸ê³¼ ë™ì¼
    â†“
[3] ë ˆì´ì–´ í•©ì„±
    â”œâ”€ ë°°ê²½ ì´ë¯¸ì§€ (í•˜ë‹¨ ë ˆì´ì–´)
    â””â”€ ì œí’ˆ ì´ë¯¸ì§€ (ìƒë‹¨ ë ˆì´ì–´, ì•ŒíŒŒ ì±„ë„)
    â†“
[4] FLUX Fill ë¸”ë Œë”©
    â”œâ”€ ê²½ê³„ì„  ìì—°ìŠ¤ëŸ½ê²Œ ì²˜ë¦¬
    â”œâ”€ ê·¸ë¦¼ì/ë°˜ì‚¬ ì¶”ê°€
    â””â”€ blending_strengthë¡œ ì œì–´
    â†“
ìµœì¢… ê²°ê³¼ (ì œí’ˆ ë³´ì¡´ + ë°°ê²½ êµì²´)
```

#### ì œì–´ íŒŒë¼ë¯¸í„°
| íŒŒë¼ë¯¸í„° | ì„¤ëª… | ë²”ìœ„ | ê¸°ë³¸ê°’ |
|---------|------|------|--------|
| **blending_strength** | í•©ì„± ìì—°ìŠ¤ëŸ¬ì›€ (ë‚®ì„ìˆ˜ë¡ ì›ë³¸ ìœ ì§€) | 0.2 ~ 0.6 | 0.35 |
| **background_prompt** | ë°°ê²½ ìƒì„± í”„ë¡¬í”„íŠ¸ | í…ìŠ¤íŠ¸ | - |
| **steps** | ìƒì„± ë°˜ë³µ íšŸìˆ˜ | 20 ~ 50 | 28 |
| **guidance_scale** | í”„ë¡¬í”„íŠ¸ ì¶©ì‹¤ë„ | 1.0 ~ 20.0 | 3.5 |

#### ë…¸ë“œ êµ¬ì„± (14ê°œ)
```yaml
1:  LoadImage              # ì´ë¯¸ì§€ ë¡œë“œ
2:  BEN2 (ë°°ê²½ ì œê±°)        # ì œí’ˆ ë¶„ë¦¬
3:  CLIPTextEncode         # ë°°ê²½ í”„ë¡¬í”„íŠ¸ ì¸ì½”ë”©
4:  UnetLoaderGGUF         # FLUX.1-dev ë¡œë“œ
5:  EmptyLatentImage       # Latent ìƒì„±
6:  KSampler               # ë°°ê²½ ì´ë¯¸ì§€ ìƒì„±
7:  VAEDecode              # VAE ë””ì½”ë”© (ë°°ê²½)
8:  ImageComposite         # ì œí’ˆ + ë°°ê²½ í•©ì„±
9:  FLUX Fill Preprocess   # Fill ì…ë ¥ ì¤€ë¹„
10: CLIPTextEncode         # ë¸”ë Œë”© í”„ë¡¬í”„íŠ¸
11: UnetLoaderGGUF         # FLUX Fill ëª¨ë¸ ë¡œë“œ
12: KSampler               # ë¸”ë Œë”© ì‹¤í–‰
13: VAEDecode              # VAE ë””ì½”ë”© (ìµœì¢…)
50: SaveImage              # ê²°ê³¼ ì €ì¥
```

---

### 3. âœ¨ ê³ ê¸‰ ëª¨ë“œ (Hybrid Mode)

#### ëª©í‘œ
**ì–¼êµ´ + ì œí’ˆ ë™ì‹œ ë³´ì¡´**, ë‚˜ë¨¸ì§€(ì˜ìƒ, ë°°ê²½) ë³€ê²½

#### ì‚¬ìš© ì‚¬ë¡€
- ëª¨ë¸ì´ ì œí’ˆì„ ë“¤ê³  ìˆëŠ” ê´‘ê³  ì´¬ì˜
- ì¸í”Œë£¨ì–¸ì„œ ì œí’ˆ ë¦¬ë·° ì½˜í…ì¸ 
- íŒ¨ì…˜ + ì•¡ì„¸ì„œë¦¬ ë™ì‹œ ì´¬ì˜
- ë¸Œëœë“œ ì•°ë²„ì„œë” ê´‘ê³ 

#### íŒŒì´í”„ë¼ì¸ êµ¬ì¡°
```
ì…ë ¥ ì´ë¯¸ì§€
    â†“
[1] Multi Detection (ì–¼êµ´ + ì œí’ˆ)
    â”œâ”€ Face Detector â†’ ì–¼êµ´ ë§ˆìŠ¤í¬
    â””â”€ Object Detector â†’ ì œí’ˆ ë§ˆìŠ¤í¬
    â†“
[2] ë©€í‹° ë§ˆìŠ¤í¬ í•©ì„±
    â”œâ”€ ì–¼êµ´ ë§ˆìŠ¤í¬ + ì œí’ˆ ë§ˆìŠ¤í¬ â†’ í†µí•© ë§ˆìŠ¤í¬
    â””â”€ ë°˜ì „ (ì–¼êµ´+ì œí’ˆ ì œì™¸ ì˜ì—­)
    â†“
[3] ControlNet Preprocessor (Canny)
    â””â”€ ì „ì²´ ìœ¤ê³½ì„  ì¶”ì¶œ (ì–¼êµ´+ì œí’ˆ ê²½ê³„ ìœ ì§€)
    â†“
[4] ControlNet + Masked I2I
    â”œâ”€ í…ìŠ¤íŠ¸ í”„ë¡¬í”„íŠ¸: "ë¹¨ê°„ ë“œë ˆìŠ¤, í•´ë³€"
    â”œâ”€ ë§ˆìŠ¤í¬: ì–¼êµ´+ì œí’ˆ ì œì™¸ ì˜ì—­ë§Œ ìˆ˜ì •
    â””â”€ ControlNet: ìœ¤ê³½ì„  ê°€ì´ë“œ
    â†“
ìµœì¢… ê²°ê³¼ (ì–¼êµ´+ì œí’ˆ ë³´ì¡´ + ì˜ìƒ/ë°°ê²½ ë³€ê²½)
```

#### ì œì–´ íŒŒë¼ë¯¸í„°
| íŒŒë¼ë¯¸í„° | ì„¤ëª… | ë²”ìœ„ | ê¸°ë³¸ê°’ |
|---------|------|------|--------|
| **controlnet_strength** | ìœ¤ê³½ì„  ìœ ì§€ ê°•ë„ | 0.0 ~ 1.0 | 0.8 |
| **denoise_strength** | ë³€ê²½ ê°•ë„ | 0.0 ~ 1.0 | 0.95 |
| **steps** | ìƒì„± ë°˜ë³µ íšŸìˆ˜ | 20 ~ 50 | 28 |
| **guidance_scale** | í”„ë¡¬í”„íŠ¸ ì¶©ì‹¤ë„ | 1.0 ~ 20.0 | 3.5 |

#### ë…¸ë“œ êµ¬ì„± (17ê°œ)
```yaml
1:  LoadImage              # ì´ë¯¸ì§€ ë¡œë“œ
10: UltralyticsDetector    # ì–¼êµ´ ê°ì§€ ëª¨ë¸
11: BboxDetectorSEGS       # ì–¼êµ´ SEGS
12: SegsToCombinedMask     # ì–¼êµ´ ë§ˆìŠ¤í¬
20: UltralyticsDetector    # ì œí’ˆ ê°ì§€ ëª¨ë¸
21: BboxDetectorSEGS       # ì œí’ˆ SEGS
22: SegsToCombinedMask     # ì œí’ˆ ë§ˆìŠ¤í¬
30: MaskComposite          # ì–¼êµ´+ì œí’ˆ ë§ˆìŠ¤í¬ í•©ì„±
31: InvertMask             # ë§ˆìŠ¤í¬ ë°˜ì „
40: CannyEdgePreprocessor  # Canny ë§µ ì¶”ì¶œ
41: ControlNetLoader       # ControlNet ë¡œë“œ
42: ControlNetApplyAdvanced # ControlNet ì ìš©
3:  CLIPTextEncode         # í…ìŠ¤íŠ¸ ì¸ì½”ë”©
4:  UnetLoaderGGUF         # FLUX.1-dev ë¡œë“œ
6:  CLIPTextEncode         # Negative í”„ë¡¬í”„íŠ¸
50: EmptyLatentImage       # Latent ìƒì„±
51: SetLatentNoiseMask     # ë§ˆìŠ¤í¬ ì ìš©
60: KSampler               # ì´ë¯¸ì§€ ìƒì„±
61: VAEDecode              # VAE ë””ì½”ë”©
70: SaveImage              # ê²°ê³¼ ì €ì¥
```

---

## ğŸ—ï¸ ê¸°ìˆ  ìŠ¤íƒ ë° ì•„í‚¤í…ì²˜

### ê¸°ìˆ  ìŠ¤íƒ

#### AI ëª¨ë¸
| ëª¨ë¸ | ìš©ë„ | ê²½ë¡œ | í¬ê¸° |
|------|------|------|------|
| **FLUX.1-dev-Q8** | ì´ë¯¸ì§€ ìƒì„± (ë©”ì¸) | `/mnt/data4/models/gguf/` | 23.8GB |
| **FLUX.1-Fill-dev-Q8** | ì¸í˜ì¸íŒ…/ë¸”ë Œë”© | `/mnt/data4/models/gguf/` | 23.8GB |
| **BEN2** | ë°°ê²½ ì œê±° | ComfyUI ë‚´ì¥ | - |
| **YOLO v8m (Face)** | ì–¼êµ´ ê°ì§€ | `/mnt/data4/models/` | ~52MB |
| **YOLO v8n** | ì œí’ˆ ê°ì§€ | `/mnt/data4/models/` | ~6MB |
| **ControlNet-Union** | êµ¬ì¡° ê°€ì´ë“œ | `/mnt/data4/models/controlnet/` | 6.2GB |
| **Depth Anything** | Depth ë§µ ì¶”ì¶œ | ComfyUI custom_nodes | - |

#### í”„ë ˆì„ì›Œí¬
- **ComfyUI**: ë…¸ë“œ ê¸°ë°˜ ì´ë¯¸ì§€ ìƒì„± íŒŒì´í”„ë¼ì¸
- **FastAPI**: REST API ë°±ì—”ë“œ
- **Streamlit**: ì›¹ í”„ë¡ íŠ¸ì—”ë“œ
- **PyTorch**: AI ëª¨ë¸ ì‹¤í–‰ (CUDA 12.8)

#### ì˜ì¡´ì„± ë¼ì´ë¸ŒëŸ¬ë¦¬
- `diffusers`, `transformers`: HuggingFace ëª¨ë¸
- `gguf`: GGUF í˜•ì‹ ëª¨ë¸ ë¡œë”©
- `ultralytics`: YOLO ê°ì²´ ê°ì§€
- `segment-anything`: SAM ë§ˆìŠ¤í¬ ìƒì„±
- `opencv-python`, `pillow`: ì´ë¯¸ì§€ ì²˜ë¦¬

### ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Frontend (Streamlit)                  â”‚
â”‚  - ëª¨ë“œ ì„ íƒ UI (Sidebar)                                 â”‚
â”‚  - íŒŒë¼ë¯¸í„° ì¡°ì • (Sliders)                                â”‚
â”‚  - ì´ë¯¸ì§€ ì—…ë¡œë“œ/ê²°ê³¼ í‘œì‹œ                                 â”‚
â”‚  - íŒŒì´í”„ë¼ì¸ ë‹¨ê³„ ì•ˆë‚´                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†• HTTP/REST API
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   Backend (FastAPI)                      â”‚
â”‚  - /api/edit_with_comfyui                                â”‚
â”‚  - Request ê²€ì¦ (Pydantic)                               â”‚
â”‚  - ì§„í–‰ìƒí™© ì½œë°± ì²˜ë¦¬                                      â”‚
â”‚  - ë¡œê·¸ ì¶œë ¥ (uvicorn.log)                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†• HTTP API
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                ComfyUI Server (Port 8188)                â”‚
â”‚  - ì›Œí¬í”Œë¡œìš° ì‹¤í–‰                                         â”‚
â”‚  - ë…¸ë“œ ê·¸ë˜í”„ ì²˜ë¦¬                                        â”‚
â”‚  - ëª¨ë¸ ë¡œë”©/ì–¸ë¡œë”©                                        â”‚
â”‚  - ì´ë¯¸ì§€ ì—…ë¡œë“œ/ë‹¤ìš´ë¡œë“œ                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†•
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  GPU (CUDA 12.8)                         â”‚
â”‚  - PyTorch ëª¨ë¸ ì‹¤í–‰                                      â”‚
â”‚  - VRAM ê´€ë¦¬ (Offload)                                   â”‚
â”‚  - ì–‘ìí™” (Q8, FP8)                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ë””ë ‰í† ë¦¬ êµ¬ì¡°

```
Ad_Content_Creation_Service_Team3/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ backend/
â”‚   â”‚   â”œâ”€â”€ main.py                    # FastAPI ì—”íŠ¸ë¦¬í¬ì¸íŠ¸
â”‚   â”‚   â”œâ”€â”€ services.py                # ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§
â”‚   â”‚   â”œâ”€â”€ comfyui_client.py          # ComfyUI API í´ë¼ì´ì–¸íŠ¸
â”‚   â”‚   â””â”€â”€ comfyui_workflows.py       # ì›Œí¬í”Œë¡œìš° ì •ì˜
â”‚   â””â”€â”€ frontend/
â”‚       â””â”€â”€ app.py                     # Streamlit ì•±
â”œâ”€â”€ configs/
â”‚   â””â”€â”€ image_editing_config.yaml      # ëª¨ë“œ ì„¤ì •
â”œâ”€â”€ comfyui/
â”‚   â”œâ”€â”€ custom_nodes/
â”‚   â”‚   â”œâ”€â”€ comfyui_controlnet_aux/    # ControlNet ì „ì²˜ë¦¬
â”‚   â”‚   â””â”€â”€ ComfyUI-Impact-Pack/       # ì–¼êµ´/ì† ê°ì§€
â”‚   â””â”€â”€ models/                        # ëª¨ë¸ ì‹¬ë³¼ë¦­ ë§í¬
â”œâ”€â”€ logs/
â”‚   â”œâ”€â”€ uvicorn.log                    # ë°±ì—”ë“œ ë¡œê·¸
â”‚   â””â”€â”€ comfyui.log                    # ComfyUI ë¡œê·¸
â”œâ”€â”€ scripts/
â”‚   â”œâ”€â”€ start_all.sh                   # ì „ì²´ ì‹œì‘
â”‚   â”œâ”€â”€ monitor_backend.sh             # ë°±ì—”ë“œ ëª¨ë‹ˆí„°ë§
â”‚   â””â”€â”€ monitor.sh                     # ComfyUI ëª¨ë‹ˆí„°ë§
â””â”€â”€ docs/
    â”œâ”€â”€ IMAGE_EDITING_SYSTEM.md        # ì´ ë¬¸ì„œ
    â””â”€â”€ PROGRESS_TRACKING.md           # ì§„í–‰ìƒí™© ì¶”ì  (ë³„ë„)
```

---

## ğŸ”„ ì›Œí¬í”Œë¡œìš° ìƒì„¸ ì„¤ê³„

### ì›Œí¬í”Œë¡œìš° JSON êµ¬ì¡°

ComfyUIëŠ” ë…¸ë“œ ê¸°ë°˜ ê·¸ë˜í”„ë¡œ íŒŒì´í”„ë¼ì¸ì„ ì •ì˜í•©ë‹ˆë‹¤:

```json
{
  "1": {
    "class_type": "LoadImage",
    "inputs": {
      "image": "input.png"
    }
  },
  "10": {
    "class_type": "UltralyticsDetectorProvider",
    "inputs": {
      "model_name": "bbox/face_yolov8m.pt"
    }
  },
  "12": {
    "class_type": "BboxDetectorSEGS",
    "inputs": {
      "image": ["1", 0],              // ë…¸ë“œ 1ì˜ ì²« ë²ˆì§¸ ì¶œë ¥
      "bbox_detector": ["10", 0],     // ë…¸ë“œ 10ì˜ ì²« ë²ˆì§¸ ì¶œë ¥
      "threshold": 0.5,
      "dilation": 10,
      "crop_factor": 3.0,
      "drop_size": 10,
      "labels": "all"
    }
  }
  // ... ì¶”ê°€ ë…¸ë“œ
}
```

### ë™ì  íŒŒë¼ë¯¸í„° ì—…ë°ì´íŠ¸

`update_workflow_inputs()` í•¨ìˆ˜ë¡œ ì‚¬ìš©ì ì…ë ¥ì„ ì›Œí¬í”Œë¡œìš°ì— ë°˜ì˜:

```python
def update_workflow_inputs(
    workflow: Dict[str, Any],
    experiment_id: str,
    prompt: str,
    negative_prompt: str = "",
    steps: int = None,
    guidance_scale: float = None,
    strength: float = None,
    seed: int = None,
    controlnet_type: str = "depth",
    controlnet_strength: float = 0.7,
    denoise_strength: float = 1.0,
    blending_strength: float = 0.35,
    background_prompt: str = None
) -> Dict[str, Any]:
    """ì›Œí¬í”Œë¡œìš°ì— ì‚¬ìš©ì íŒŒë¼ë¯¸í„° ì£¼ì…"""

    if experiment_id == "portrait_mode":
        # í…ìŠ¤íŠ¸ í”„ë¡¬í”„íŠ¸
        workflow["5"]["inputs"]["text"] = prompt

        # ControlNet ê°•ë„
        workflow["22"]["inputs"]["strength"] = controlnet_strength

        # Denoise ê°•ë„ (ë³€ê²½ ì •ë„)
        workflow["40"]["inputs"]["denoise"] = denoise_strength

        # ControlNet íƒ€ì… ì „í™˜ (Depth â†” Canny)
        if controlnet_type == "canny":
            workflow["20"] = {
                "class_type": "CannyEdgePreprocessor",
                "inputs": {
                    "image": ["1", 0],
                    "low_threshold": 100,
                    "high_threshold": 200
                }
            }

    # ... ë‹¤ë¥¸ ëª¨ë“œë„ ìœ ì‚¬í•˜ê²Œ ì²˜ë¦¬
```

---

## ğŸ“Š ì§„í–‰ìƒí™© ì¶”ì  ì‹œìŠ¤í…œ

### ì„¤ê³„ ëª©ì 
- ì‚¬ìš©ì: í˜„ì¬ ì–´ë–¤ ë‹¨ê³„ê°€ ì§„í–‰ ì¤‘ì¸ì§€ ì•Œê³  ì‹¶ìŒ
- ê°œë°œì: ë¬¸ì œ ë°œìƒ ì‹œ ì–´ëŠ ë‹¨ê³„ì—ì„œ ë©ˆì·„ëŠ”ì§€ ë””ë²„ê¹…
- ìš´ì˜ì: ê° ë‹¨ê³„ë³„ ì„±ëŠ¥ ì¸¡ì • ë° ë³‘ëª© êµ¬ê°„ íŒŒì•…

### êµ¬í˜„ ë°©ì‹

#### 1. ComfyUI ë…¸ë“œ ì™„ë£Œ ê°ì§€

```python
# comfyui_client.py
def wait_for_completion(self, prompt_id: str, progress_callback: callable):
    completed_nodes = set()

    while True:
        history = self.get_history(prompt_id)

        # ì™„ë£Œëœ ë…¸ë“œ í™•ì¸
        outputs = history.get("outputs", {})
        for node_id in outputs.keys():
            if node_id not in completed_nodes:
                completed_nodes.add(node_id)
                # ì½œë°± í˜¸ì¶œ
                progress_callback(node_id=node_id, elapsed=elapsed)
```

#### 2. ë…¸ë“œ ID â†’ ë‹¨ê³„ëª… ë§¤í•‘

```python
# comfyui_workflows.py
def get_pipeline_steps_for_mode(experiment_id: str) -> Dict[str, str]:
    if experiment_id == "portrait_mode":
        return {
            "1": "ğŸ“¥ ì´ë¯¸ì§€ ë¡œë“œ",
            "12": "ğŸ‘¤ ì–¼êµ´ ì˜ì—­ ê°ì§€ ì¤‘...",
            "40": "ğŸš€ ì´ë¯¸ì§€ ìƒì„± ì¤‘... (KSampler)",
            # ... ì´ 16ê°œ ë…¸ë“œ
        }
```

#### 3. ì§„í–‰ìƒí™© ë¡œê¹…

```python
# services.py
def progress_callback(node_id: str, elapsed: float):
    step_name = pipeline_steps.get(node_id, f"ë…¸ë“œ {node_id}")
    step_count[0] += 1
    logger.info(
        f"   [{step_count[0]:2d}/{len(pipeline_steps):2d}] "
        f"{step_name} (ê²½ê³¼: {elapsed:.1f}ì´ˆ)"
    )
```

### ë¡œê·¸ ì¶œë ¥ ì˜ˆì‹œ

```bash
ğŸ¨ ComfyUI ì´ë¯¸ì§€ í¸ì§‘ ì‹œì‘
   ëª¨ë“œ: ğŸ‘¤ ì¸ë¬¼ ëª¨ë“œ
   í”„ë¡¬í”„íŠ¸: í•‘í¬ìƒ‰ ë¹„í‚¤ë‹ˆ ìˆ˜ì˜ë³µì„ ì…ê³  í•´ìˆ˜ìš•ì¥
ğŸ”„ ì›Œí¬í”Œë¡œìš° ì‹¤í–‰ ì‹œì‘ (ì´ 16ë‹¨ê³„)
   [ 1/16] ğŸ“¥ ì´ë¯¸ì§€ ë¡œë“œ (ê²½ê³¼: 0.5ì´ˆ)
   [ 2/16] ğŸ” ì–¼êµ´ ê°ì§€ ëª¨ë¸ ë¡œë“œ (ê²½ê³¼: 1.2ì´ˆ)
   [ 3/16] ğŸ‘¤ ì–¼êµ´ ì˜ì—­ ê°ì§€ ì¤‘... (ê²½ê³¼: 2.8ì´ˆ)
   ...
   [16/16] ğŸ’¾ ê²°ê³¼ ì €ì¥ (ê²½ê³¼: 45.2ì´ˆ)
âœ… ComfyUI í¸ì§‘ ì™„ë£Œ! (ì†Œìš” ì‹œê°„: 45.8ì´ˆ)
```

---

## ğŸ–¥ï¸ ì‚¬ìš©ì ì¸í„°í˜ì´ìŠ¤

### í˜ì´ì§€ ë ˆì´ì•„ì›ƒ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        Sidebar                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  âœ¨ í¸ì§‘ ëª¨ë“œ ì„ íƒ                                         â”‚
â”‚  [ ğŸ‘¤ ì¸ë¬¼ ëª¨ë“œ    â–¼ ]                                    â”‚
â”‚                                                          â”‚
â”‚  ğŸ”§ ëª¨ë¸ ì„ íƒ (ìƒì„± ì „ìš©)                                  â”‚
â”‚  [ FLUX.1-dev-Q8 â–¼ ]                                     â”‚
â”‚  [ FLUX.1-dev-Q4 â–¼ ]                                     â”‚
â”‚                                                          â”‚
â”‚  ğŸ“Š ë°±ì—”ë“œ/ComfyUI ìƒíƒœ                                   â”‚
â”‚  âœ… Backend: Running                                     â”‚
â”‚  âœ… ComfyUI: Connected                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Main Content                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  1ï¸âƒ£ ì´ë¯¸ì§€ ì—…ë¡œë“œ                                         â”‚
â”‚  [ğŸ“ Browse files...]                                    â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚
â”‚  2ï¸âƒ£ í”„ë¡¬í”„íŠ¸ ì…ë ¥                                         â”‚
â”‚  Prompt: [í•‘í¬ìƒ‰ ë¹„í‚¤ë‹ˆ ìˆ˜ì˜ë³µì„ ì…ê³  í•´ë³€ì—ì„œ...]          â”‚
â”‚  Negative: [low quality, blurry...]                     â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚
â”‚  3ï¸âƒ£ íŒŒë¼ë¯¸í„° ì¡°ì •                                         â”‚
â”‚  Steps: [â”â”â”â”â”â—â”â”] 28                                    â”‚
â”‚  Guidance: [â”â”â—â”â”â”â”] 3.5                                 â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚
â”‚  4ï¸âƒ£ ëª¨ë“œë³„ ì˜µì…˜ (Portrait/Hybrid)                        â”‚
â”‚  ì²´í˜• ìœ ì§€ ë°©ì‹: [ depth â–¼ ]                              â”‚
â”‚  ì²´í˜• ìœ ì§€ ê°•ë„: [â”â”â”â”â—â”â”â”] 0.7                           â”‚
â”‚  ë³€ê²½ ê°•ë„: [â”â”â”â”â”â”â”â—] 1.0                                â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚
â”‚  5ï¸âƒ£ ì‹¤í–‰                                                 â”‚
â”‚  [ğŸ¨ ì´ë¯¸ì§€ í¸ì§‘ ì‹œì‘]                                     â”‚
â”‚                                                          â”‚
â”‚  ğŸ’¡ ê° ëª¨ë“œ ì‚¬ìš© ì˜ˆì‹œ (í•­ìƒ í‘œì‹œ)                          â”‚
â”‚  ğŸ‘¤ ì¸ë¬¼ ëª¨ë“œ                                             â”‚
â”‚  â€¢ ê°€ìƒ ì˜ìƒ í”¼íŒ…                                         â”‚
â”‚  â€¢ í”„ë¡œí•„ ì‚¬ì§„ ë°°ê²½ ë³€ê²½                                   â”‚
â”‚  ...                                                     â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚
â”‚  6ï¸âƒ£ í¸ì§‘ ê²°ê³¼                                            â”‚
â”‚  [ ì›ë³¸ ì´ë¯¸ì§€ ]  [ í¸ì§‘ ê²°ê³¼ ]                           â”‚
â”‚  [â¬‡ï¸ ë‹¤ìš´ë¡œë“œ]                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### UI ì»´í¬ë„ŒíŠ¸ ìƒì„¸

#### 1. ëª¨ë“œ ì„ íƒ (Sidebar)

```python
EDITING_MODES = {
    "portrait_mode": {
        "id": "portrait_mode",
        "name": "ğŸ‘¤ ì¸ë¬¼ ëª¨ë“œ",
        "icon": "ğŸ‘¤",
        "description": "ì–¼êµ´ì€ ë³´ì¡´í•˜ê³ , ì˜ìƒê³¼ ë°°ê²½ì„ ìì—°ìŠ¤ëŸ½ê²Œ ë³€ê²½",
        "use_cases": [
            "ê°€ìƒ ì˜ìƒ í”¼íŒ… (íŒ¨ì…˜ e-ì»¤ë¨¸ìŠ¤)",
            "í”„ë¡œí•„ ì‚¬ì§„ ë°°ê²½ ë³€ê²½",
            "ì»¨ì…‰ í¬í†  ìƒì„± (ê²°í˜¼, ì¡¸ì—…)"
        ]
    },
    "product_mode": {
        "id": "product_mode",
        "name": "ğŸ“¦ ì œí’ˆ ëª¨ë“œ",
        "icon": "ğŸ“¦",
        "description": "ì œí’ˆì€ ë³´ì¡´í•˜ê³ , ë°°ê²½ì„ ì°½ì˜ì ìœ¼ë¡œ ë³€ê²½",
        "use_cases": [
            "ì œí’ˆ ê´‘ê³  ì†Œì¬ ì œì‘",
            "e-ì»¤ë¨¸ìŠ¤ ìƒí’ˆ ì´ë¯¸ì§€ í–¥ìƒ",
            "íŒ¨í‚¤ì§€ ë””ìì¸ ëª©ì—…"
        ]
    },
    "hybrid_mode": {
        "id": "hybrid_mode",
        "name": "âœ¨ ê³ ê¸‰ ëª¨ë“œ",
        "icon": "âœ¨",
        "description": "ì–¼êµ´+ì œí’ˆì„ ë™ì‹œì— ë³´ì¡´í•˜ê³ , ë‚˜ë¨¸ì§€ ë³€ê²½",
        "use_cases": [
            "ëª¨ë¸ì´ ì œí’ˆì„ ë“¤ê³  ìˆëŠ” ê´‘ê³  ì´¬ì˜",
            "ì¸í”Œë£¨ì–¸ì„œ ì œí’ˆ ë¦¬ë·° ì½˜í…ì¸ ",
            "íŒ¨ì…˜ + ì•¡ì„¸ì„œë¦¬ ë™ì‹œ ì´¬ì˜"
        ]
    }
}

selected_mode_name = st.sidebar.selectbox(
    "í¸ì§‘ ëª¨ë“œ",
    mode_names,
    help="ì›í•˜ëŠ” í¸ì§‘ ëª¨ë“œë¥¼ ì„ íƒí•˜ì„¸ìš”",
    key="editing_mode_selector"
)
```

#### 2. ëª¨ë“œë³„ íŒŒë¼ë¯¸í„° (Main)

**Portrait/Hybrid Mode**:
```python
col1, col2, col3 = st.columns(3)

with col1:
    controlnet_type = st.selectbox(
        "ì²´í˜• ìœ ì§€ ë°©ì‹",
        ["depth", "canny"],
        index=0,
        help="Depth: ì²´í˜•/í¬ì¦ˆ ìœ ì§€ | Canny: ì†ê°€ë½ ë””í…Œì¼ ìœ ì§€"
    )

with col2:
    controlnet_strength = st.slider(
        "ì²´í˜• ìœ ì§€ ê°•ë„",
        min_value=0.0, max_value=1.0, value=0.7, step=0.05,
        help="ë†’ì„ìˆ˜ë¡ ì›ë³¸ ì²´í˜•/í¬ì¦ˆ ìœ ì§€"
    )

with col3:
    denoise_strength = st.slider(
        "ë³€ê²½ ê°•ë„",
        min_value=0.0, max_value=1.0, value=1.0, step=0.05,
        help="1.0 = ì™„ì „íˆ ìƒˆë¡œ ê·¸ë¦¼, 0.8 = ì•½ê°„ ë³´ì¡´"
    )
```

**Product Mode**:
```python
blending_strength = st.slider(
    "í•©ì„± ìì—°ìŠ¤ëŸ¬ì›€",
    min_value=0.2, max_value=0.6, value=0.35, step=0.05,
    help="ë‚®ì„ìˆ˜ë¡ ì œí’ˆ ì›ë³¸ ìœ ì§€, ë†’ì„ìˆ˜ë¡ ìì—°ìŠ¤ëŸ¬ìš´ ë¸”ë Œë”©"
)
```

#### 3. ì§„í–‰ìƒí™© í‘œì‹œ

```python
# íŒŒì´í”„ë¼ì¸ ë‹¨ê³„ ì•ˆë‚´
st.info(f"ğŸ¨ **{mode_name} íŒŒì´í”„ë¼ì¸ ì‹¤í–‰ ì¤‘...**\n\n" +
       "1. ğŸ“¥ ì´ë¯¸ì§€ ì—…ë¡œë“œ ë° ì „ì²˜ë¦¬\n" +
       "2. ğŸ” ì–¼êµ´ ì˜ì—­ ìë™ ê°ì§€\n" +
       "3. ğŸ­ ì–¼êµ´ ë§ˆìŠ¤í¬ ìƒì„± ë° ë°˜ì „\n" +
       "4. ğŸ“Š ì²´í˜• ê°€ì´ë“œ ì¶”ì¶œ (Depth/Canny)\n" +
       "5. ğŸ¨ ControlNet ì ìš©\n" +
       "6. ğŸš€ ì´ë¯¸ì§€ ìƒì„± (ì˜ìƒ/ë°°ê²½ ë³€ê²½)\n" +
       "7. ğŸ’¾ ê²°ê³¼ ì €ì¥ ë° í›„ì²˜ë¦¬\n\n" +
       "ğŸ’¡ ë°±ì—”ë“œ ë¡œê·¸ë¥¼ ëª¨ë‹ˆí„°ë§í•˜ì—¬ ì‹¤ì‹œê°„ ì§„í–‰ìƒí™©ì„ í™•ì¸í•˜ì„¸ìš”!")

with st.spinner(f"{mode_name} ì‹¤í–‰ ì¤‘... ì ì‹œë§Œ ê¸°ë‹¤ë ¤ì£¼ì„¸ìš” (í‰ê·  30-60ì´ˆ ì†Œìš”)"):
    result = api.edit_with_comfyui(payload)
```

---

## ğŸ”§ ì„¤ì¹˜ ë° ì„¤ì •

### 1. í™˜ê²½ ìš”êµ¬ì‚¬í•­

- **OS**: Ubuntu 22.04 LTS
- **GPU**: NVIDIA (CUDA 12.8 ì§€ì›)
- **VRAM**: ìµœì†Œ 24GB (ê¶Œì¥ 40GB+)
- **Python**: 3.12
- **íŒ¨í‚¤ì§€ ê´€ë¦¬ì**: `uv`

### 2. ì˜ì¡´ì„± ì„¤ì¹˜

```bash
# Python ì˜ì¡´ì„±
uv sync

# PyTorch with CUDA
uv pip uninstall torch
uv pip install torch torchvision --index-url https://download.pytorch.org/whl/cu128

# ComfyUI custom nodes
cd comfyui/custom_nodes
git clone https://github.com/Fannovel16/comfyui_controlnet_aux
cd comfyui_controlnet_aux
uv pip install -r requirements.txt
```

### 3. ëª¨ë¸ ë‹¤ìš´ë¡œë“œ

```bash
# FLUX ëª¨ë¸ (GGUF)
/mnt/data4/models/gguf/
â”œâ”€â”€ FLUX.1-dev-Q8.gguf           # 23.8GB
â””â”€â”€ FLUX.1-Fill-dev-Q8.gguf      # 23.8GB

# ControlNet ëª¨ë¸
/mnt/data4/models/controlnet/
â””â”€â”€ InstantX-FLUX.1-dev-Controlnet-Union.safetensors  # 6.2GB

# YOLO ëª¨ë¸ (Impact Pack)
/mnt/data4/models/ultralytics/bbox/
â”œâ”€â”€ face_yolov8m.pt              # ~52MB
â””â”€â”€ yolov8n.pt                   # ~6MB

# ì‹¬ë³¼ë¦­ ë§í¬ ìƒì„±
cd comfyui/models
ln -s /mnt/data4/models/* .
```

### 4. ì„œë¹„ìŠ¤ ì‹œì‘

```bash
# ì „ì²´ ì‹œì‘ (ComfyUI + Backend + Frontend)
./scripts/start_all.sh

# ê°œë³„ ì‹œì‘
# ComfyUI
cd comfyui && python main.py --listen 0.0.0.0 --port 8188

# Backend
uv run uvicorn src.backend.main:app --host 0.0.0.0 --port 8000 --reload

# Frontend
uv run streamlit run src/frontend/app.py --server.port 8501
```

### 5. ì„œë¹„ìŠ¤ í™•ì¸

```bash
# Backend
curl http://localhost:8000/status

# ComfyUI
curl http://localhost:8188/system_stats

# Frontend
# ë¸Œë¼ìš°ì €: http://localhost:8501
```

---

## ğŸ“ˆ ì„±ëŠ¥ ìµœì í™”

### 1. ëª¨ë¸ ì–‘ìí™”
- **Q8 (8-bit)**: í’ˆì§ˆ ê±°ì˜ ì†ì‹¤ ì—†ìŒ, ì†ë„ 2-3ë°° í–¥ìƒ
- **Q4 (4-bit)**: ì•½ê°„ì˜ í’ˆì§ˆ ì†ì‹¤, ì†ë„ 4-5ë°° í–¥ìƒ

### 2. VRAM ê´€ë¦¬
- **Offload**: CPU RAMìœ¼ë¡œ ëª¨ë¸ ì¼ë¶€ ì´ë™
- **Unload**: ì‚¬ìš© ì•ˆ í•˜ëŠ” ëª¨ë¸ ì–¸ë¡œë“œ

```bash
# ComfyUI ë©”ëª¨ë¦¬ í•´ì œ
curl -X POST http://localhost:8188/free
```

### 3. ë°°ì¹˜ ì²˜ë¦¬
- ì—¬ëŸ¬ ì´ë¯¸ì§€ë¥¼ í•œ ë²ˆì— ì²˜ë¦¬ (í”„ë¡ íŠ¸ì—”ë“œ ë¯¸êµ¬í˜„)

---

## ğŸ› ë¬¸ì œ í•´ê²°

### ë¬¸ì œ 1: ControlNet ëª¨ë¸ ëª» ì°¾ìŒ

**ì¦ìƒ**:
```
control_net_name: 'InstantX-FLUX.1-dev-Controlnet-Union.safetensors' not in []
```

**í•´ê²°**:
```bash
# ëª¨ë¸ ë‹¤ìš´ë¡œë“œ
wget -P /mnt/data4/models/controlnet/ \
  https://huggingface.co/InstantX/FLUX.1-dev-Controlnet-Union/resolve/main/diffusion_pytorch_model.safetensors

# ì´ë¦„ ë³€ê²½
mv /mnt/data4/models/controlnet/diffusion_pytorch_model.safetensors \
   /mnt/data4/models/controlnet/InstantX-FLUX.1-dev-Controlnet-Union.safetensors

# ComfyUI ì¬ì‹œì‘
pkill -f "python comfyui/main.py"
./scripts/start_all.sh
```

---

### ë¬¸ì œ 2: ì–¼êµ´ ê°ì§€ ì‹¤íŒ¨

**ì¦ìƒ**:
ë¡œê·¸ì— "ì–¼êµ´ ì˜ì—­ ê°ì§€ ì¤‘..." í›„ ë©ˆì¶¤

**ì›ì¸**:
- YOLO ëª¨ë¸ ì—†ìŒ
- ì´ë¯¸ì§€ì— ì–¼êµ´ ì—†ìŒ
- Threshold ë„ˆë¬´ ë†’ìŒ

**í•´ê²°**:
```bash
# ëª¨ë¸ í™•ì¸
ls /mnt/data4/models/ultralytics/bbox/face_yolov8m.pt

# ì—†ìœ¼ë©´ ë‹¤ìš´ë¡œë“œ
mkdir -p /mnt/data4/models/ultralytics/bbox
wget -P /mnt/data4/models/ultralytics/bbox/ \
  https://github.com/Fannovel16/ComfyUI-Impact-Pack/releases/download/V0.1/face_yolov8m.pt
```

---

### ë¬¸ì œ 3: Out of Memory (VRAM)

**ì¦ìƒ**:
```
CUDA out of memory. Tried to allocate XX.XX GiB
```

**í•´ê²°**:
```python
# 1. Q4 ëª¨ë¸ ì‚¬ìš© (VRAM ì ˆë°˜)
model_path = "/mnt/data4/models/gguf/FLUX.1-dev-Q4.gguf"

# 2. í•´ìƒë„ ë‚®ì¶”ê¸°
workflow["30"]["inputs"]["width"] = 768
workflow["30"]["inputs"]["height"] = 768

# 3. ComfyUI ë©”ëª¨ë¦¬ í•´ì œ
curl -X POST http://localhost:8188/free
```

---

## ğŸ“š ì°¸ê³  ìë£Œ

### ê³µì‹ ë¬¸ì„œ
- [ComfyUI GitHub](https://github.com/comfyanonymous/ComfyUI)
- [FLUX.1 HuggingFace](https://huggingface.co/black-forest-labs/FLUX.1-dev)
- [ControlNet-Union](https://huggingface.co/InstantX/FLUX.1-dev-Controlnet-Union)
- [Impact Pack](https://github.com/ltdrdata/ComfyUI-Impact-Pack)

### ê´€ë ¨ ë…¼ë¬¸
- FLUX.1: [Black Forest Labs Technical Report](https://blackforestlabs.ai/)
- ControlNet: [Adding Conditional Control to Text-to-Image Diffusion Models](https://arxiv.org/abs/2302.05543)
- Depth Anything: [Depth Anything V2](https://arxiv.org/abs/2406.09414)

---

## ğŸ“ ë²„ì „ íˆìŠ¤í† ë¦¬

### v3.0.0 (2025-11-28)
- âœ¨ 3ê°€ì§€ í¸ì§‘ ëª¨ë“œ êµ¬ì¶• (Portrait/Product/Hybrid)
- âœ¨ ì§„í–‰ìƒí™© ì¶”ì  ì‹œìŠ¤í…œ êµ¬í˜„
- âœ¨ ControlNet Aux ë…¸ë“œ í†µí•©
- ğŸ› Qwen ëª¨ë¸ ì œê±° (ì•ˆì •ì„± ë¬¸ì œ)
- ğŸ“ UI ì¬ì„¤ê³„ (ëª¨ë“œ ì„ íƒ sidebar ì´ë™)

### v2.5.0 (ì´ì „)
- ComfyUI í†µí•©
- FLUX.1-dev GGUF ì§€ì›
- BEN2 + Qwen ì‹¤í—˜

---

## ğŸ‘¥ íŒ€ ì •ë³´

**Ad Content Creation Service Team3**

**ì£¼ìš” ê¸°ì—¬ì**:
- ì‹œìŠ¤í…œ ì„¤ê³„ ë° êµ¬í˜„
- ComfyUI ì›Œí¬í”Œë¡œìš° ê°œë°œ
- ì§„í–‰ìƒí™© ì¶”ì  ì‹œìŠ¤í…œ ê°œë°œ

**ë¬¸ì˜**: [GitHub Issues](https://github.com/...)

---

**ì‘ì„±ì¼**: 2025-11-28
**ë²„ì „**: v3.0.0
**ë¼ì´ì„ ìŠ¤**: MIT
