# image_editing_config.yaml
# AI ì´ë¯¸ì§€ í¸ì§‘ ì‹œìŠ¤í…œ ì„¤ì • íŒŒì¼ (v3.0)

# ComfyUI ì—°ê²° ì„¤ì •
comfyui:
  base_url: "http://localhost:8188"
  timeout: 600  # ì´ˆ (10ë¶„) - 2025-12-02 ìˆ˜ì •: 300ì´ˆ â†’ 600ì´ˆ (ë³µì¡í•œ ì›Œí¬í”Œë¡œìš° ëŒ€ì‘)

# ëª¨ë¸ ì €ì¥ ê²½ë¡œ
model_base_path: "/mnt/data4/models"

# ============================================================
# í¸ì§‘ ëª¨ë“œ ì •ì˜ (Portrait / Product / Hybrid)
# ============================================================

editing_modes:
  # ğŸŸ¢ ëª¨ë“œ A: ì¸ë¬¼ ëª¨ë“œ (Portrait)
  # ëª©í‘œ: ì–¼êµ´(ID) 100% ë³´ì¡´, ì˜·/ë°°ê²½ë§Œ ë³€ê²½
  portrait:
    id: "portrait_mode"
    name: "ğŸ‘¤ ì¸ë¬¼ ëª¨ë“œ"
    description: "ì–¼êµ´ì€ ë³´ì¡´í•˜ê³ , ì˜ìƒê³¼ ë°°ê²½ì„ ìì—°ìŠ¤ëŸ½ê²Œ ë³€ê²½"
    icon: "ğŸ‘¤"

    # ì‚¬ìš© ëª¨ë¸
    models:
      background_removal: "BEN2"
      face_detection: "Impact Pack (Face Detector)"
      image_editing: "FLUX.1-dev-Q8"
      controlnet: "Depth / Canny"

    # ì›Œí¬í”Œë¡œìš° ë‹¨ê³„
    pipeline:
      - step: 1
        name: "ì–¼êµ´ ê°ì§€"
        action: "Face Detectorë¡œ ì–¼êµ´ ì˜ì—­ ë§ˆìŠ¤í¬ ìƒì„±"
        node: "FaceDetailer"

      - step: 2
        name: "ë§ˆìŠ¤í¬ ë°˜ì „"
        action: "ì–¼êµ´ ì œì™¸í•œ ë‚˜ë¨¸ì§€(ëª¸+ë°°ê²½)ë¥¼ ìˆ˜ì • ì˜ì—­ìœ¼ë¡œ ì„¤ì •"
        node: "InvertMask"

      - step: 3
        name: "ê°€ì´ë“œ ì¶”ì¶œ"
        action: "ControlNetìš© Depth/Canny Map ì¶”ì¶œ (ì²´í˜•/í¬ì¦ˆ ìœ ì§€)"
        node: "ControlNetPreprocessor"

      - step: 4
        name: "ìƒì„± ë° í•©ì„±"
        action: "Masked I2I + ControlNetìœ¼ë¡œ ì˜·/ë°°ê²½ë§Œ ë³€ê²½"
        node: "KSampler"

    # ì œì–´ íŒŒë¼ë¯¸í„°
    controls:
      - name: "ì–¼êµ´ ë³´í˜¸"
        type: "auto"
        description: "Face Detector ìë™ ì‹¤í–‰"

      - name: "ìŠ¤íƒ€ì¼ ì •ì˜"
        type: "text_prompt"
        description: "ì›í•˜ëŠ” ì˜ìƒê³¼ ë°°ê²½ ì„¤ëª…"
        placeholder: "ì˜ˆ: Wearing a red dress, beach background..."

      - name: "ì²´í˜• ìœ ì§€ ê°•ë„"
        type: "slider"
        param: "controlnet_strength"
        min: 0.0
        max: 1.0
        default: 0.7
        description: "ë†’ì„ìˆ˜ë¡ ì›ë³¸ ì²´í˜•/í¬ì¦ˆ ìœ ì§€"

      - name: "ë³€ê²½ ê°•ë„"
        type: "slider"
        param: "denoise_strength"
        min: 0.0
        max: 1.0
        default: 1.0
        description: "1.0 = ì™„ì „íˆ ìƒˆë¡œ ê·¸ë¦¼, 0.8 = ì•½ê°„ ë³´ì¡´"

    # íŒŒë¼ë¯¸í„° ê¸°ë³¸ê°’
    params:
      default_steps: 28
      guidance_scale: 3.5
      controlnet_type: "depth"  # depth ë˜ëŠ” canny
      controlnet_strength: 0.7
      denoise_strength: 1.0

  # ğŸ”µ ëª¨ë“œ B: ì œí’ˆ ëª¨ë“œ (Product)
  # ëª©í‘œ: ì œí’ˆ ë””í…Œì¼ ë³´ì¡´, ë°°ê²½ë§Œ í™”ë ¤í•˜ê²Œ êµì²´
  product:
    id: "product_mode"
    name: "ğŸ“¦ ì œí’ˆ ëª¨ë“œ"
    description: "ì œí’ˆì€ ë³´ì¡´í•˜ê³ , ë°°ê²½ì„ ì°½ì˜ì ìœ¼ë¡œ ë³€ê²½"
    icon: "ğŸ“¦"

    # ì‚¬ìš© ëª¨ë¸
    models:
      background_removal: "BEN2"
      background_generation: "FLUX.1-dev-Q8 (T2I)"
      blending: "FLUX.1-Fill-dev-Q8"

    # ì›Œí¬í”Œë¡œìš° ë‹¨ê³„
    pipeline:
      - step: 1
        name: "ëˆ„ë¼ ë”°ê¸°"
        action: "BEN2ë¡œ ì œí’ˆ ë§ˆìŠ¤í¬(Alpha) ì •ë°€ ì¶”ì¶œ"
        node: "BEN2"

      - step: 2
        name: "ë°°ê²½ ìƒì„±"
        action: "Flux Dev T2Ië¡œ í™”ë ¤í•œ ë°°ê²½ ë”°ë¡œ ìƒì„±"
        node: "FluxDevT2I"

      - step: 3
        name: "ë ˆì´ì–´ í•©ì„±"
        action: "ìƒì„±ëœ ë°°ê²½ ìœ„ì— ëˆ„ë¼ ë”´ ì œí’ˆ ì–¹ê¸°"
        node: "ImageOverlay"

      - step: 4
        name: "ìì—°ìŠ¤ëŸ¬ìš´ ìœµí•©"
        action: "Flux Fillë¡œ ë¹› ë°˜ì‚¬, ê·¸ë¦¼ì ìƒì„±, ì´ì§ˆê° ì œê±°"
        node: "FluxFill"

    # ì œì–´ íŒŒë¼ë¯¸í„°
    controls:
      - name: "ì œí’ˆ ë¶„ë¦¬"
        type: "auto"
        description: "BEN2 ìë™ ì‹¤í–‰"

      - name: "ë°°ê²½ ë‚´ìš©"
        type: "text_prompt"
        description: "ì›í•˜ëŠ” ë°°ê²½ ì„¤ëª…"
        placeholder: "ì˜ˆ: Cyberpunk city, neon lights, futuristic..."

      - name: "ë°°ê²½ ë””í…Œì¼"
        type: "slider"
        param: "guidance_scale"
        min: 3.0
        max: 10.0
        default: 5.0
        description: "ë†’ì„ìˆ˜ë¡ í”„ë¡¬í”„íŠ¸ ë°˜ì˜ ê°•í•¨"

      - name: "í•©ì„± ìì—°ìŠ¤ëŸ¬ì›€"
        type: "slider"
        param: "blending_strength"
        min: 0.2
        max: 0.6
        default: 0.35
        description: "ë‚®ì„ìˆ˜ë¡ ì›ë³¸ ì œí’ˆ ë³´ì¡´, ë†’ì„ìˆ˜ë¡ ë°°ê²½ê³¼ ìœµí•©"

    # íŒŒë¼ë¯¸í„° ê¸°ë³¸ê°’
    params:
      default_steps: 28
      guidance_scale: 5.0
      blending_strength: 0.35
      background_steps: 28

  # ğŸŸ£ ëª¨ë“œ C: í•˜ì´ë¸Œë¦¬ë“œ ëª¨ë“œ (Portrait + Product)
  # ëª©í‘œ: ì–¼êµ´+ì œí’ˆ ë™ì‹œ ë³´ì¡´, ì˜·/ë°°ê²½ë§Œ ë³€ê²½
  hybrid:
    id: "hybrid_mode"
    name: "âœ¨ ê³ ê¸‰ ëª¨ë“œ"
    description: "ì¸ë¬¼ê³¼ ì œí’ˆì„ ë™ì‹œì— ë³´ì¡´í•˜ê³ , ë‚˜ë¨¸ì§€ë§Œ ë³€ê²½"
    icon: "âœ¨"

    # ì‚¬ìš© ëª¨ë¸
    models:
      face_detection: "Impact Pack (Face Detector)"
      product_detection: "BEN2 or SAM"
      image_editing: "FLUX.1-dev-Q8"
      controlnet: "Canny (ê¶Œì¥)"

    # ì›Œí¬í”Œë¡œìš° ë‹¨ê³„
    pipeline:
      - step: 1
        name: "ë©€í‹° ë§ˆìŠ¤í‚¹"
        action: "ì–¼êµ´(Face Detector) + ì œí’ˆ(BEN2) ë§ˆìŠ¤í¬ í•©ì§‘í•©"
        node: "MultiMask"

      - step: 2
        name: "ë§ˆìŠ¤í¬ ë°˜ì „"
        action: "ì–¼êµ´+ì œí’ˆ ì œì™¸í•œ ë‚˜ë¨¸ì§€(ì˜·+ë°°ê²½)ë¥¼ ìˆ˜ì • ì˜ì—­ìœ¼ë¡œ"
        node: "InvertMask"

      - step: 3
        name: "ë””í…Œì¼ ê°€ì´ë“œ"
        action: "Cannyë¡œ ì†ê°€ë½/ì œí’ˆ ê·¸ë¦½ ë””í…Œì¼ ì¶”ì¶œ"
        node: "ControlNetCanny"

      - step: 4
        name: "ìƒì„±"
        action: "Masked I2I + ControlNetìœ¼ë¡œ ì˜·/ë°°ê²½ë§Œ ë³€ê²½"
        node: "KSampler"

    # ì œì–´ íŒŒë¼ë¯¸í„°
    controls:
      - name: "ë³´í˜¸ ì˜ì—­ ì„ íƒ"
        type: "multi_auto"
        description: "ì–¼êµ´(ìë™) + ì œí’ˆ(ìë™ ë˜ëŠ” í´ë¦­)"

      - name: "ìƒí™©/ì˜ìƒ ì •ì˜"
        type: "text_prompt"
        description: "ì›í•˜ëŠ” ì˜ìƒê³¼ ìƒí™© ì„¤ëª…"
        placeholder: "ì˜ˆ: Woman in suit, holding bottle, office background..."

      - name: "ë””í…Œì¼ ê°•ì œ"
        type: "select"
        param: "controlnet_type"
        options: ["canny", "depth"]
        default: "canny"
        description: "Canny = ì†ê°€ë½ ì„ ëª…, Depth = ì²´í˜• ìœ ì§€"

      - name: "ìƒì„± ê°•ë„"
        type: "slider"
        param: "denoise_strength"
        min: 0.7
        max: 1.0
        default: 0.9
        description: "ë†’ì„ìˆ˜ë¡ ê°•í•˜ê²Œ ë‹¤ì‹œ ê·¸ë¦¼"

    # íŒŒë¼ë¯¸í„° ê¸°ë³¸ê°’
    params:
      default_steps: 28
      guidance_scale: 3.5
      controlnet_type: "canny"
      controlnet_strength: 0.8
      denoise_strength: 0.9

  # ğŸŸ  ëª¨ë“œ D: FLUX.1-Fill (Inpainting/Outpainting)
  # ëª©í‘œ: ë§ˆìŠ¤í¬ ì˜ì—­ ì±„ìš°ê¸° ë˜ëŠ” ì´ë¯¸ì§€ í™•ì¥
  flux_fill:
    id: "flux_fill_mode"
    name: "ğŸ–Œï¸ ì¸í˜ì¸íŒ… ëª¨ë“œ"
    description: "ë§ˆìŠ¤í¬ ì˜ì—­ì„ ìƒˆë¡œìš´ ë‚´ìš©ìœ¼ë¡œ ì±„ìš°ê±°ë‚˜ ì´ë¯¸ì§€ í™•ì¥"
    icon: "ğŸ–Œï¸"

    # ì‚¬ìš© ëª¨ë¸
    models:
      background_removal: "BEN2 (ì„ íƒì )"
      inpainting: "FLUX.1-Fill-dev-Q8"

    # ì›Œí¬í”Œë¡œìš° ë‹¨ê³„
    pipeline:
      - step: 1
        name: "ì´ë¯¸ì§€ ë¡œë“œ"
        action: "ì…ë ¥ ì´ë¯¸ì§€ ë¡œë“œ"
        node: "LoadImage"

      - step: 2
        name: "ë§ˆìŠ¤í¬ ìƒì„±"
        action: "BEN2 ë°°ê²½ ì œê±° ë˜ëŠ” ìˆ˜ë™ ë§ˆìŠ¤í¬"
        node: "BEN2 or Manual"

      - step: 3
        name: "ì¸í˜ì¸íŒ…"
        action: "FLUX Fillë¡œ ë§ˆìŠ¤í¬ ì˜ì—­ ì±„ìš°ê¸°"
        node: "KSampler"

      - step: 4
        name: "ê²°ê³¼ ì €ì¥"
        action: "ìµœì¢… ì´ë¯¸ì§€ ì €ì¥"
        node: "SaveImage"

    # ì œì–´ íŒŒë¼ë¯¸í„°
    controls:
      - name: "í¸ì§‘ í”„ë¡¬í”„íŠ¸"
        type: "text_prompt"
        description: "ë§ˆìŠ¤í¬ ì˜ì—­ì— ìƒì„±í•  ë‚´ìš©"
        placeholder: "ì˜ˆ: ë°°ê²½ì„ í˜„ëŒ€ì ì¸ ì²´ìœ¡ê´€ìœ¼ë¡œ ë³€ê²½"

      - name: "ë³€ê²½ ê°•ë„"
        type: "slider"
        param: "denoise_strength"
        min: 0.5
        max: 1.0
        default: 0.9
        description: "ë†’ì„ìˆ˜ë¡ ë³€í™” í¼"

      - name: "ìë™ ë°°ê²½ ì œê±°"
        type: "checkbox"
        param: "use_ben2"
        default: true
        description: "BEN2ë¡œ ìë™ ë§ˆìŠ¤í¬ ìƒì„±"

    # íŒŒë¼ë¯¸í„° ê¸°ë³¸ê°’
    params:
      default_steps: 28
      guidance_scale: 3.5
      denoise_strength: 0.9
      use_ben2: true

  # ğŸŸ¡ ëª¨ë“œ E: Qwen-Image-Edit (ì •ë°€ í¸ì§‘)
  # ëª©í‘œ: ìì—°ì–´ ê¸°ë°˜ ì •ë°€ ì´ë¯¸ì§€ í¸ì§‘
  qwen_edit:
    id: "qwen_edit_mode"
    name: "ğŸ¯ ì •ë°€ í¸ì§‘ ëª¨ë“œ"
    description: "ìì—°ì–´ ëª…ë ¹ìœ¼ë¡œ ì •ë°€í•˜ê²Œ ì´ë¯¸ì§€ í¸ì§‘"
    icon: "ğŸ¯"

    # ì‚¬ìš© ëª¨ë¸
    models:
      image_editing: "Qwen-Image-Edit-2509-Q8"

    # ì›Œí¬í”Œë¡œìš° ë‹¨ê³„
    pipeline:
      - step: 1
        name: "ì´ë¯¸ì§€ ë¡œë“œ"
        action: "ì…ë ¥ ì´ë¯¸ì§€ ë¡œë“œ"
        node: "LoadImage"

      - step: 2
        name: "ëª…ë ¹ ì¸ì½”ë”©"
        action: "ìì—°ì–´ í¸ì§‘ ëª…ë ¹ ì²˜ë¦¬"
        node: "CLIPTextEncode"

      - step: 3
        name: "ì •ë°€ í¸ì§‘"
        action: "Qwenìœ¼ë¡œ ì´ë¯¸ì§€ í¸ì§‘"
        node: "KSampler"

      - step: 4
        name: "ê²°ê³¼ ì €ì¥"
        action: "ìµœì¢… ì´ë¯¸ì§€ ì €ì¥"
        node: "SaveImage"

    # ì œì–´ íŒŒë¼ë¯¸í„°
    controls:
      - name: "í¸ì§‘ ëª…ë ¹"
        type: "text_prompt"
        description: "ìì—°ì–´ë¡œ í¸ì§‘ ë‚´ìš© ì„¤ëª…"
        placeholder: "ì˜ˆ: ìš´ë™ë³µì„ íŒŒë€ìƒ‰ì—ì„œ ë¹¨ê°„ìƒ‰ìœ¼ë¡œ ë³€ê²½"

      - name: "í¸ì§‘ ê°•ë„"
        type: "slider"
        param: "strength"
        min: 0.5
        max: 1.0
        default: 0.7
        description: "ë†’ì„ìˆ˜ë¡ ë³€í™” í¼"

    # íŒŒë¼ë¯¸í„° ê¸°ë³¸ê°’
    params:
      default_steps: 28
      guidance_scale: 3.5
      strength: 0.7

    # ì›Œí¬í”Œë¡œìš° ë‹¨ê³„
    pipeline:
      - step: 1
        name: "ë©€í‹° ë§ˆìŠ¤í‚¹"
        action: "ì–¼êµ´(Face Detector) + ì œí’ˆ(BEN2) ë§ˆìŠ¤í¬ í•©ì§‘í•©"
        node: "MultiMask"

      - step: 2
        name: "ë§ˆìŠ¤í¬ ë°˜ì „"
        action: "ì–¼êµ´+ì œí’ˆ ì œì™¸í•œ ë‚˜ë¨¸ì§€(ì˜·+ë°°ê²½)ë¥¼ ìˆ˜ì • ì˜ì—­ìœ¼ë¡œ"
        node: "InvertMask"

      - step: 3
        name: "ë””í…Œì¼ ê°€ì´ë“œ"
        action: "Cannyë¡œ ì†ê°€ë½/ì œí’ˆ ê·¸ë¦½ ë””í…Œì¼ ì¶”ì¶œ"
        node: "ControlNetCanny"

      - step: 4
        name: "ìƒì„±"
        action: "Masked I2I + ControlNetìœ¼ë¡œ ì˜·/ë°°ê²½ë§Œ ë³€ê²½"
        node: "KSampler"

    # ì œì–´ íŒŒë¼ë¯¸í„°
    controls:
      - name: "ë³´í˜¸ ì˜ì—­ ì„ íƒ"
        type: "multi_auto"
        description: "ì–¼êµ´(ìë™) + ì œí’ˆ(ìë™ ë˜ëŠ” í´ë¦­)"

      - name: "ìƒí™©/ì˜ìƒ ì •ì˜"
        type: "text_prompt"
        description: "ì›í•˜ëŠ” ì˜ìƒê³¼ ìƒí™© ì„¤ëª…"
        placeholder: "ì˜ˆ: Woman in suit, holding bottle, office background..."

      - name: "ë””í…Œì¼ ê°•ì œ"
        type: "select"
        param: "controlnet_type"
        options: ["canny", "depth"]
        default: "canny"
        description: "Canny = ì†ê°€ë½ ì„ ëª…, Depth = ì²´í˜• ìœ ì§€"

      - name: "ìƒì„± ê°•ë„"
        type: "slider"
        param: "denoise_strength"
        min: 0.7
        max: 1.0
        default: 0.9
        description: "ë†’ì„ìˆ˜ë¡ ê°•í•˜ê²Œ ë‹¤ì‹œ ê·¸ë¦¼"

    # íŒŒë¼ë¯¸í„° ê¸°ë³¸ê°’
    params:
      default_steps: 28
      guidance_scale: 3.5
      controlnet_type: "canny"
      controlnet_strength: 0.8
      denoise_strength: 0.9

# ============================================================
# ê³µí†µ ëª¨ë¸ ì„¤ì •
# ============================================================

models:
  # BEN2 ë°°ê²½ ì œê±°
  ben2:
    name: "BEN2"
    path: "/mnt/data4/models/ben2"
    url: "https://github.com/PramaLLC/BEN2"
    threshold: 0.5

  # FLUX.1-dev-Q8 (ì´ë¯¸ì§€ ìƒì„±/í¸ì§‘)
  flux_dev:
    name: "FLUX.1-dev-Q8"
    path: "/mnt/data4/models/flux1-dev-Q8_0.gguf"
    type: "gguf"

  # FLUX.1-Fill (Inpainting)
  flux_fill:
    name: "FLUX.1-Fill-dev-Q8"
    path: "/home/shared/FLUX.1-Fill-dev-Q8_0.gguf"
    type: "gguf"

  # Qwen-Image-Edit (ì •ë°€ í¸ì§‘)
  qwen_edit:
    name: "Qwen-Image-Edit-2509-Q8"
    path: "/home/shared/Qwen-Image-Edit-2509-Q8_0.gguf"
    type: "gguf"

  # Impact Pack (Face/Hand Detector)
  impact_pack:
    name: "Impact Pack"
    detectors:
      face: "bbox/face_yolov8m.pt"
      hand: "bbox/hand_yolov8s.pt"

# ============================================================
# ì´ë¯¸ì§€ ì²˜ë¦¬ ê³µí†µ ì„¤ì •
# ============================================================

image_processing:
  # ì§€ì› í¬ë§·
  supported_formats: ["png", "jpg", "jpeg", "webp"]

  # ìµœëŒ€ í•´ìƒë„
  max_resolution:
    width: 2048
    height: 2048

  # ê¸°ë³¸ ì¶œë ¥ í¬ê¸°
  default_output_size:
    width: 1024
    height: 1024
